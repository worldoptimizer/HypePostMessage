/*
 HypePostMessage v1.0.1
 Copyright (2024) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';window.HypePostMessage||(window.HypePostMessage=function(){function g(a,d,b={}){const e=b.selector||"iframe",c=b.direction||"parent";a={type:"HypePostEvent",name:a,data:d,propagate:b.propagate||!1,direction:c};try{switch(c){case "parent":window.parent.postMessage(JSON.parse(JSON.stringify(a)),"*");break;case "children":const f=document.querySelectorAll(e),l=JSON.parse(JSON.stringify(a));f.forEach(m=>{m.contentWindow.postMessage(l,"*")});break;default:console.warn(`HypePostMessage: Unknown direction '${c}'`)}}catch(f){console.warn(`HypePostMessage: Error posting event to ${c}:`,
f)}}function h(a,d,b={}){g("HypePostMessage",{behavior:d,documentId:b.documentId},{propagate:b.propagate||!1,selector:b.selector||"iframe",direction:b.direction||"parent"})}function k(a){if(a.detail.name==="HypePostMessage"){var {data:d}=a.detail;window.HYPE&&window.HYPE.documents&&Object.values(window.HYPE.documents).forEach(b=>{b&&(!d.documentId||Array.isArray(d.documentId)&&d.documentId.includes(b.documentId())||d.documentId===b.documentId())&&b.triggerCustomBehaviorNamed(d.behavior,d)})}}document.addEventListener("HypePostEventReceived",
function(a){a.detail.name==="HypePostMessage"&&k(a)});window.addEventListener("message",function(a){if(a.data.type==="HypePostEvent"){var {name:d,data:b,propagate:e,direction:c}=a.data;a=new CustomEvent("HypePostEventReceived",{detail:{name:d,data:b,propagate:e}});document.dispatchEvent(a);e&&c&&(a=window.parent&&window.parent!==window,c==="parent"&&a?g(d,b,{propagate:!0,direction:"parent"}):c==="children"&&g(d,b,{propagate:!0,direction:"children"}))}},!1);window.HYPE_eventListeners||(window.HYPE_eventListeners=
[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,d,b){a.postEventToParent=function(e,c,f={}){g(e,c,{...f,direction:"parent"})};a.postEventToChildren=function(e,c,f={}){g(e,c,{...f,direction:"children"})};a.postBehaviorToParent=function(e,c={}){h(a,e,{...c,direction:"parent"})};a.postBehaviorToChildren=function(e,c={}){h(a,e,{...c,direction:"children"})}}});return{version:"1.0.1",Propagation:{NONE:"none",UP:"up",DOWN:"down"},postEvent:g,postBehavior:h,handleBehaviorEvent:k}}());
